var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{Z:()=>h});class s{constructor(e){this.ctx=e}strokeFrameForTest(e,t){this.ctx.strokeStyle=t,this.ctx.strokeRect(e.x,e.y,e.w,e.h),this.ctx.strokeStyle="black"}getContentFrame(){const{width:e,height:t}=this.ctx.canvas,s=Math.floor(Math.min(e,t)/100);return{x:s,y:s,w:e-2*s,h:t-2*s}}getTitleFrame(e){const t=Math.floor(e.h/10);return{x:e.x,y:e.y,h:t,w:e.w}}getRemainingContentFrame(e,t){return{x:e.x,y:e.y<t.y?e.y:t.y+t.h,w:e.w,h:e.h-t.h}}getLegendFrame(e){const t=Math.floor(e.h/10);return{x:e.x,y:e.y+e.h-t,h:t,w:e.w}}drawTitle(e,t){const{ctx:s}=this,r=this.getTitleFrame(t),{x:i,y:n,w:o,h:a}=r;s.font=`${Math.floor(a/2)}px sans-serif`;const h=s.measureText(e),c=i+o/2-h.width/2,l=n+a/2+h.actualBoundingBoxAscent/2;return s.fillText(e,c,l,o),this.strokeFrameForTest(r,"red"),this.getRemainingContentFrame(t,r)}drawLegend(e){const t=this.getLegendFrame(e);return this.strokeFrameForTest(t,"green"),this.getRemainingContentFrame(e,t)}prepareChartForDrawing(e){const{ctx:t}=this,{width:s,height:r}=t.canvas;this.ctx.clearRect(0,0,s,r);let i=this.getContentFrame();return this.strokeFrameForTest(i,"blue"),e.showTitle&&e.title&&(i=this.drawTitle(e.title,i)),e.showLegend&&(i=this.drawLegend(i)),this.strokeFrameForTest(i,"yellow"),i}}const r=class{static sliceOrFill(e,t,s){if(e.length===t)return e;if(e.length>t)return e.slice(0,t);if(e.length<t)for(;e.length!==t;)e.push(null!=s?s:0);return e}static mergeRight(e,t){const s=Object.keys(t);Object.entries(e).forEach((e=>{const r=e[0];if(s.includes(r)){const s=e[1];t[r]=s}}))}};class i{constructor(e){let t=e;if("string"==typeof t&&(t=document.getElementById(t.replace("/^#/",""))),t instanceof HTMLCanvasElement)this.context=t.getContext("2d");else{if(!(t instanceof CanvasRenderingContext2D))throw Error("Argument must be valid ID, HTMLCanvasElement or CanvasRenderingContext2D");this.context=t}this.chartOptions={title:"Untitled",showTitle:!0,showLegend:!1},this.seriesData=[],this.plot=new s(this.context)}setChartOptions(e){r.mergeRight(e,this.chartOptions)}setSerieOptions(e,t){t?t.forEach((t=>{const s=this.seriesData.find((e=>e.name==t));s?r.mergeRight(e,s.options):console.warn(`Serie with name ${t} not found.`)})):this.seriesData.forEach((t=>r.mergeRight(e,t.options)))}}class n extends i{constructor(e){super(e)}set X(e){this.dataLabels=e}set Y(e){const{length:t}=this.dataLabels;if(!t)throw Error('Values on "X" axis must be specified before setting "Y" values.');const s=e.map((e=>r.sliceOrFill(e,t)));this.seriesData=s.map(((e,t)=>this.getDefaultSerieObject(e,t)))}getDefaultSerieObject(e,t){return{values:e,name:`serie${t}`,options:{color:Math.floor(16777215*Math.random()).toString(16),showLabels:!1,showOnLegend:!1,edgeThickness:0}}}draw(){}}class o extends s{constructor(e){super(e.ctx)}drawPie(e,t){const{ctx:s}=this,r=this.prepareChartForDrawing(t),i=this.mapSeriesToPieDegAndColor(e),n=Math.min(r.w,r.h)/2.5,o={x:r.x+r.w/2,y:r.y+r.h/2};let a=0;i.forEach((e=>{s.fillStyle=e.color,s.beginPath(),s.moveTo(o.x,o.y),s.arc(o.x,o.y,n,a,a+=e.rad),s.lineTo(o.x,o.y),s.fill()})),a=0,i.forEach((e=>{e.thickness>0?(s.strokeStyle="black",s.lineWidth=e.thickness,s.beginPath(),s.moveTo(o.x,o.y),s.arc(o.x,o.y,n,a,a+=e.rad),s.lineTo(o.x,o.y),s.stroke()):a+=e.rad}))}mapSeriesToPieDegAndColor(e){const t=e.map((e=>e.value)).reduce(((e,t)=>e+t),0);return e.map((e=>({rad:2*e.value*Math.PI/t,color:e.options.color,thickness:e.options.edgeThickness})))}}class a extends i{constructor(e){super(e),this.plot=new o(this.plot)}set X(e){this.seriesData=e.map((e=>this.getDefaultSerieObject(e)))}set Y(e){const{length:t}=this.seriesData;if(!t)throw Error('Values on "X" axis must be specified before setting "Y" values.');const s=r.sliceOrFill(e,t);this.seriesData.map(((e,t)=>{e.value=s[t]}))}getDefaultSerieObject(e){return{value:0,name:e,options:{color:Math.floor(16777215*Math.random()).toString(16),showLabels:!1,showOnLegend:!1,edgeThickness:0}}}draw(){this.plot.drawPie(this.seriesData,this.chartOptions)}}function h(e,t){switch(e.toLowerCase().trim()){case"pie":return new a(t);case"bar":return new n(t);default:throw new Error(`${e} chart is not defined.`)}}var c=t.Z;export{c as default};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixHQUNOMUQsS0FBS3FFLEtBQU8sSUFBSStCLEVBQVFwRyxLQUFLcUUsTUFHdEJlLE1BQUVDLEdBQ1RyRixLQUFLb0UsV0FDRGlCLEVBQU9LLEtBQUttQyxHQUFVN0gsS0FBSzRGLHNCQUFzQmlDLEtBRzlDdEMsTUFBRU0sR0FDVCxNQUFNLE9BQUUvQyxHQUFXOUMsS0FBS29FLFdBQ3hCLElBQUt0QixFQUNELE1BQU1xQixNQUFNLG1FQUNoQixNQUFNMkQsRUFBZSxjQUF1QmpDLEVBQVEvQyxHQUNwRDlDLEtBQUtvRSxXQUFXc0IsS0FBSSxDQUFDcUMsRUFBUXBDLEtBQ3pCb0MsRUFBT3ZFLE1BQVFzRSxFQUFhbkMsTUFJNUJDLHNCQUFzQmlDLEdBQzFCLE1BQU8sQ0FDSHJFLE1BQU8sRUFDUHNCLEtBQU0rQyxFQUNOdEQsUUFBUyxDQUNMcEUsTUFBT1ksS0FBS0MsTUFBc0IsU0FBaEJELEtBQUsrRSxVQUFxQkMsU0FBUyxJQUNyREMsWUFBWSxFQUNaQyxjQUFjLEVBQ2RDLGNBQWUsSUFLcEJDLE9BQ0huRyxLQUFLcUUsS0FBS2lDLFFBQVF0RyxLQUFLb0UsV0FBWXBFLEtBQUtzQyxlQ3ZDakMsU0FBUzBGLEVBQVdDLEVBQWN2RSxHQUM3QyxPQUFRdUUsRUFBS0MsY0FBY0MsUUFDdkIsSUFBSyxNQUNELE9BQU8sSUFBSVAsRUFBU2xFLEdBQ3hCLElBQUssTUFDRCxPQUFPLElBQUl3QixFQUFTeEIsR0FDeEIsUUFDSSxNQUFNLElBQUlTLE1BQU0sR0FBRzhELDRCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGJyei93ZWJnbC1jaGFydC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9AYnJ6L3dlYmdsLWNoYXJ0L3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9AYnJ6L3dlYmdsLWNoYXJ0L3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vQGJyei93ZWJnbC1jaGFydC8uL3NyYy9wbG90L1Bsb3RTa2VsZXRvbi50cyIsIndlYnBhY2s6Ly9AYnJ6L3dlYmdsLWNoYXJ0Ly4vc3JjL21vZGVsL3V0aWxzLnRzIiwid2VicGFjazovL0Bicnovd2ViZ2wtY2hhcnQvLi9zcmMvbW9kZWwvQ2hhcnQudHMiLCJ3ZWJwYWNrOi8vQGJyei93ZWJnbC1jaGFydC8uL3NyYy9tb2RlbC9CYXJDaGFydC50cyIsIndlYnBhY2s6Ly9AYnJ6L3dlYmdsLWNoYXJ0Ly4vc3JjL3Bsb3QvUGllUGxvdC50cyIsIndlYnBhY2s6Ly9AYnJ6L3dlYmdsLWNoYXJ0Ly4vc3JjL21vZGVsL1BpZUNoYXJ0LnRzIiwid2VicGFjazovL0Bicnovd2ViZ2wtY2hhcnQvLi9zcmMvaW50ZXJmYWNlL0NoYXJ0U2VydmFudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCB7IENoYXJ0T3B0aW9ucyB9IGZyb20gXCIuLi9tb2RlbC90eXBlc1wiO1xyXG5pbXBvcnQgeyBGcmFtZVJlY3QgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxvdFNrZWxldG9uIHtcclxuICAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKSB7XHJcbiAgICAgICAgdGhpcy5jdHggPSBjdHg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdHJva2VGcmFtZUZvclRlc3QoZnJhbWU6IEZyYW1lUmVjdCwgY29sb3I6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gY29sb3I7XHJcbiAgICAgICAgdGhpcy5jdHguc3Ryb2tlUmVjdChmcmFtZS54LCBmcmFtZS55LCBmcmFtZS53LCBmcmFtZS5oKTtcclxuICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9ICdibGFjayc7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDb250ZW50RnJhbWUoKTogRnJhbWVSZWN0IHtcclxuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHRoaXMuY3R4LmNhbnZhcztcclxuICAgICAgICBjb25zdCBwYWRkaW5nID0gTWF0aC5mbG9vcihNYXRoLm1pbih3aWR0aCwgaGVpZ2h0KSAvIDEwMCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogcGFkZGluZyxcclxuICAgICAgICAgICAgeTogcGFkZGluZyxcclxuICAgICAgICAgICAgdzogd2lkdGggLSAyICogcGFkZGluZyxcclxuICAgICAgICAgICAgaDogaGVpZ2h0IC0gMiAqIHBhZGRpbmcsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFRpdGxlRnJhbWUoY29udGVudEZyYW1lOiBGcmFtZVJlY3QpOiBGcmFtZVJlY3Qge1xyXG4gICAgICAgIGNvbnN0IEZSQU1FX0hFSUdIVF9ESVZJREVSID0gMTA7XHJcbiAgICAgICAgY29uc3QgbmV3SCA9IE1hdGguZmxvb3IoY29udGVudEZyYW1lLmggLyBGUkFNRV9IRUlHSFRfRElWSURFUik7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogY29udGVudEZyYW1lLngsXHJcbiAgICAgICAgICAgIHk6IGNvbnRlbnRGcmFtZS55LFxyXG4gICAgICAgICAgICBoOiBuZXdILFxyXG4gICAgICAgICAgICB3OiBjb250ZW50RnJhbWUud1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRSZW1haW5pbmdDb250ZW50RnJhbWUocHJldjogRnJhbWVSZWN0LCByZWNlbnQ6IEZyYW1lUmVjdCk6IEZyYW1lUmVjdCB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogcHJldi54LFxyXG4gICAgICAgICAgICB5OiBwcmV2LnkgPCByZWNlbnQueSA/IHByZXYueSA6IHJlY2VudC55ICsgcmVjZW50LmgsXHJcbiAgICAgICAgICAgIHc6IHByZXYudyxcclxuICAgICAgICAgICAgaDogcHJldi5oIC0gcmVjZW50LmhcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0TGVnZW5kRnJhbWUoZnJhbWU6IEZyYW1lUmVjdCk6IEZyYW1lUmVjdCB7XHJcbiAgICAgICAgY29uc3QgRlJBTUVfSEVJR0hUX0RJVklERVIgPSAxMDtcclxuICAgICAgICBjb25zdCBuZXdIID0gTWF0aC5mbG9vcihmcmFtZS5oIC8gRlJBTUVfSEVJR0hUX0RJVklERVIpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHg6IGZyYW1lLngsXHJcbiAgICAgICAgICAgIHk6IGZyYW1lLnkgKyBmcmFtZS5oIC0gbmV3SCxcclxuICAgICAgICAgICAgaDogbmV3SCxcclxuICAgICAgICAgICAgdzogZnJhbWUud1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkcmF3VGl0bGUodGl0bGU6IHN0cmluZywgY29udGVudEZyYW1lOiBGcmFtZVJlY3QpOiBGcmFtZVJlY3Qge1xyXG4gICAgICAgIGNvbnN0IHsgY3R4IH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnN0IHRpdGxlRnJhbWUgPSB0aGlzLmdldFRpdGxlRnJhbWUoY29udGVudEZyYW1lKTtcclxuICAgICAgICBjb25zdCB7IHgsIHksIHcsIGggfSA9IHRpdGxlRnJhbWU7XHJcbiAgICAgICAgY3R4LmZvbnQgPSBgJHtNYXRoLmZsb29yKGggLyAyKX1weCBzYW5zLXNlcmlmYDtcclxuICAgICAgICBjb25zdCB0ZXh0TWVhc3VyZW1lbnQgPSBjdHgubWVhc3VyZVRleHQodGl0bGUpO1xyXG4gICAgICAgIGNvbnN0IHRleHRXaWR0aCA9IHRleHRNZWFzdXJlbWVudC53aWR0aDtcclxuICAgICAgICBjb25zdCB0ZXh0SGVpZ2h0ID0gdGV4dE1lYXN1cmVtZW50LmFjdHVhbEJvdW5kaW5nQm94QXNjZW50O1xyXG4gICAgICAgIGNvbnN0IHRleHRQb3NpdGlvblggPSB4ICsgdyAvIDIgLSB0ZXh0V2lkdGggLyAyO1xyXG4gICAgICAgIGNvbnN0IHRleHRQb3NpdGlvblkgPSB5ICsgaCAvIDIgKyB0ZXh0SGVpZ2h0IC8gMjtcclxuICAgICAgICBjdHguZmlsbFRleHQodGl0bGUsIHRleHRQb3NpdGlvblgsIHRleHRQb3NpdGlvblksIHcpO1xyXG4gICAgICAgIHRoaXMuc3Ryb2tlRnJhbWVGb3JUZXN0KHRpdGxlRnJhbWUsICdyZWQnKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZW1haW5pbmdDb250ZW50RnJhbWUoY29udGVudEZyYW1lLCB0aXRsZUZyYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRyYXdMZWdlbmQoY29udGVudEZyYW1lOiBGcmFtZVJlY3QpOiBGcmFtZVJlY3Qge1xyXG4gICAgICAgIGNvbnN0IGxlZ2VuZEZyYW1lID0gdGhpcy5nZXRMZWdlbmRGcmFtZShjb250ZW50RnJhbWUpO1xyXG4gICAgICAgIHRoaXMuc3Ryb2tlRnJhbWVGb3JUZXN0KGxlZ2VuZEZyYW1lLCAnZ3JlZW4nKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZW1haW5pbmdDb250ZW50RnJhbWUoY29udGVudEZyYW1lLCBsZWdlbmRGcmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIHByZXBhcmVDaGFydEZvckRyYXdpbmcoY2hhcnRPcHRpb25zOiBDaGFydE9wdGlvbnMpOiBGcmFtZVJlY3Qge1xyXG4gICAgICAgIGNvbnN0IHsgY3R4IH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gY3R4LmNhbnZhcztcclxuICAgICAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XHJcblxyXG4gICAgICAgIGxldCBjb250ZW50RnJhbWUgPSB0aGlzLmdldENvbnRlbnRGcmFtZSgpO1xyXG4gICAgICAgIHRoaXMuc3Ryb2tlRnJhbWVGb3JUZXN0KGNvbnRlbnRGcmFtZSwgJ2JsdWUnKTtcclxuICAgICAgICBpZiAoY2hhcnRPcHRpb25zLnNob3dUaXRsZSAmJiBjaGFydE9wdGlvbnMudGl0bGUpXHJcbiAgICAgICAgICAgIGNvbnRlbnRGcmFtZSA9IHRoaXMuZHJhd1RpdGxlKGNoYXJ0T3B0aW9ucy50aXRsZSwgY29udGVudEZyYW1lKTtcclxuICAgICAgICBpZiAoY2hhcnRPcHRpb25zLnNob3dMZWdlbmQpXHJcbiAgICAgICAgICAgIGNvbnRlbnRGcmFtZSA9IHRoaXMuZHJhd0xlZ2VuZChjb250ZW50RnJhbWUpO1xyXG4gICAgICAgIHRoaXMuc3Ryb2tlRnJhbWVGb3JUZXN0KGNvbnRlbnRGcmFtZSwgJ3llbGxvdycpO1xyXG4gICAgICAgIHJldHVybiBjb250ZW50RnJhbWU7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyB7XHJcbiAgICAvKipcclxuICAgICAqIElmIG5lZWRlZCwgc2xpY2UgJ2FycmF5JyB0byAnbGVuJyBpdGVtcyBvciBmaWxsIHRvICdsZW4nIGl0ZW1zIHVzaW5nICdmaWxsV2l0aCcuXHJcbiAgICAgKiBAcGFyYW0gYXJyYXkgLSBhcnJheSB0byBzbGljZSBvciBmaWxsLlxyXG4gICAgICogQHBhcmFtIGxlbiAtIHRoZSByZXN1bHRpbmcgbGVuZ3RoIG9mIGFycmF5LlxyXG4gICAgICogQHBhcmFtIGZpbGxXaXRoIC0gbnVtYmVyIHdpdGggd2hpY2ggYXJyYXkgc2hvdWxkIGJlIGZpbGxlZC5cclxuICAgICAqIEByZXR1cm5zIHNsaWNlZCBvciBmaWxsZWQgYXJyYXkuXHJcbiAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBzbGljZU9yRmlsbChhcnJheTogbnVtYmVyW10sIGxlbjogbnVtYmVyLCBmaWxsV2l0aD86IG51bWJlcik6IG51bWJlcltdIHtcclxuICAgICAgICBpZiAoYXJyYXkubGVuZ3RoID09PSBsZW4pIHJldHVybiBhcnJheTtcclxuICAgICAgICBpZiAoYXJyYXkubGVuZ3RoID4gbGVuKSByZXR1cm4gYXJyYXkuc2xpY2UoMCwgbGVuKTtcclxuICAgICAgICBpZiAoYXJyYXkubGVuZ3RoIDwgbGVuKVxyXG4gICAgICAgICAgICB3aGlsZSAoYXJyYXkubGVuZ3RoICE9PSBsZW4pXHJcbiAgICAgICAgICAgICAgICBhcnJheS5wdXNoKGZpbGxXaXRoID8/IDApO1xyXG4gICAgICAgIHJldHVybiBhcnJheTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1lcmdlIHByb3BlcnRpZXMgZnJvbSAnbmV3T3B0aW9ucycgdG8gJ2FjdHVhbE9wdGlvbnMnIChyaWdodC1qb2luIGxpa2UpLlxyXG4gICAgICogQHBhcmFtIG5ld09wdGlvbnMgLSBzb21lIG9wdGlvbiBwcm9wZXJ0aWVzIGZvciB0eXBlIFQuXHJcbiAgICAgKiBAcGFyYW0gYWN0dWFsT3B0aW9ucyAtIGFsbCBvcHRpb24gcHJvcGVydGllcyBmb3IgdHlwZSBULlxyXG4gICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgbWVyZ2VSaWdodDxUPihuZXdPcHRpb25zOiBQYXJ0aWFsPFQ+LCBhY3R1YWxPcHRpb25zOiBUKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFjdHVhbE9wdGlvbnMpO1xyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKG5ld09wdGlvbnMpLmZvckVhY2gocGFpciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IHBhaXJbMF07XHJcbiAgICAgICAgICAgIGlmIChrZXlzLmluY2x1ZGVzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcGFpclsxXTtcclxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQgXHJcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICBhY3R1YWxPcHRpb25zW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgU2VyaWVEYXRhQ29tbW9uLCBDaGFydE9wdGlvbnMsIENvbnRleHRTb3VyY2UsIFNlcmllT3B0aW9ucyB9IGZyb20gXCIuL3R5cGVzXCI7XHJcbmltcG9ydCBQbG90IGZyb20gXCIuLi9wbG90L1Bsb3RTa2VsZXRvblwiO1xyXG5pbXBvcnQgQ2hhcnRVdGlscyBmcm9tIFwiLi91dGlsc1wiO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENoYXJ0IHtcclxuXHJcbiAgICBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcbiAgICBzZXJpZXNEYXRhOiBTZXJpZURhdGFDb21tb25bXTtcclxuICAgIGNoYXJ0T3B0aW9uczogQ2hhcnRPcHRpb25zO1xyXG4gICAgcGxvdDogUGxvdDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2U6IENvbnRleHRTb3VyY2UpIHtcclxuICAgICAgICBsZXQgYW5hbHl6ZWRFbGVtZW50ID0gc291cmNlO1xyXG4gICAgICAgIGlmICh0eXBlb2YgYW5hbHl6ZWRFbGVtZW50ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBhbmFseXplZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhbmFseXplZEVsZW1lbnQucmVwbGFjZSgnL14jLycsICcnKSkgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhbmFseXplZEVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQgPSBhbmFseXplZEVsZW1lbnQuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYW5hbHl6ZWRFbGVtZW50IGluc3RhbmNlb2YgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGFuYWx5emVkRWxlbWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB0aHJvdyBFcnJvcignQXJndW1lbnQgbXVzdCBiZSB2YWxpZCBJRCwgSFRNTENhbnZhc0VsZW1lbnQgb3IgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEJyk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hhcnRPcHRpb25zID0ge1xyXG4gICAgICAgICAgICB0aXRsZTogJ1VudGl0bGVkJyxcclxuICAgICAgICAgICAgc2hvd1RpdGxlOiB0cnVlLFxyXG4gICAgICAgICAgICBzaG93TGVnZW5kOiBmYWxzZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc2VyaWVzRGF0YSA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLnBsb3QgPSBuZXcgUGxvdCh0aGlzLmNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRDaGFydE9wdGlvbnMob3B0aW9uczogUGFydGlhbDxDaGFydE9wdGlvbnM+KTogdm9pZCB7XHJcbiAgICAgICAgQ2hhcnRVdGlscy5tZXJnZVJpZ2h0KG9wdGlvbnMsIHRoaXMuY2hhcnRPcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0U2VyaWVPcHRpb25zKG5ld09wdGlvbnM6IFBhcnRpYWw8U2VyaWVPcHRpb25zPiwgd2hpY2hTZXJpZXM/OiBzdHJpbmdbXSk6IHZvaWQge1xyXG4gICAgICAgIGlmICh3aGljaFNlcmllcykgd2hpY2hTZXJpZXMuZm9yRWFjaCgoc2VyaWVOYW1lKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdHVhbFNlcmllID1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWVzRGF0YS5maW5kKChleGlzdGluZ1NlcmllKSA9PiBleGlzdGluZ1NlcmllLm5hbWUgPT0gc2VyaWVOYW1lKTtcclxuICAgICAgICAgICAgaWYgKGFjdHVhbFNlcmllKSB7XHJcbiAgICAgICAgICAgICAgICBDaGFydFV0aWxzLm1lcmdlUmlnaHQobmV3T3B0aW9ucywgYWN0dWFsU2VyaWUub3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNlcmllIHdpdGggbmFtZSAke3NlcmllTmFtZX0gbm90IGZvdW5kLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZWxzZSB0aGlzLnNlcmllc0RhdGEuZm9yRWFjaCgoc2VyaWUpID0+IENoYXJ0VXRpbHMubWVyZ2VSaWdodChuZXdPcHRpb25zLCBzZXJpZS5vcHRpb25zKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFic3RyYWN0IHNldCBYKHZhbHVlOiBzdHJpbmdbXSB8IG51bWJlcltdIHwgbnVtYmVyW11bXSk7XHJcbiAgICBwdWJsaWMgYWJzdHJhY3Qgc2V0IFkodmFsdWU6IG51bWJlcltdIHwgbnVtYmVyW11bXSk7XHJcbiAgICBwdWJsaWMgYWJzdHJhY3QgZHJhdygpOiB2b2lkO1xyXG59IiwiaW1wb3J0IHsgTXVsdGlTZXJpZURhdGEsIENvbnRleHRTb3VyY2UgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBDaGFydCB9IGZyb20gXCIuL0NoYXJ0XCI7XHJcbmltcG9ydCBDaGFydFV0aWxzIGZyb20gXCIuL3V0aWxzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmFyQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XHJcbiAgICBkYXRhTGFiZWxzOiBzdHJpbmdbXTtcclxuICAgIHNlcmllc0RhdGE6IE11bHRpU2VyaWVEYXRhW107XHJcblxyXG4gICAgY29uc3RydWN0b3Ioc291cmNlOiBDb250ZXh0U291cmNlKSB7XHJcbiAgICAgICAgc3VwZXIoc291cmNlKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IFgobGFiZWxzOiBzdHJpbmdbXSkge1xyXG4gICAgICAgIHRoaXMuZGF0YUxhYmVscyA9IGxhYmVscztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IFkoc2VyaWVzOiBudW1iZXJbXVtdKSB7XHJcbiAgICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXMuZGF0YUxhYmVscztcclxuICAgICAgICBpZiAoIWxlbmd0aClcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1ZhbHVlcyBvbiBcIlhcIiBheGlzIG11c3QgYmUgc3BlY2lmaWVkIGJlZm9yZSBzZXR0aW5nIFwiWVwiIHZhbHVlcy4nKTtcclxuICAgICAgICBjb25zdCBtYXBwZWRTZXJpZXMgPSBzZXJpZXMubWFwKHNlcmllID0+IENoYXJ0VXRpbHMuc2xpY2VPckZpbGwoc2VyaWUsIGxlbmd0aCkpO1xyXG4gICAgICAgIHRoaXMuc2VyaWVzRGF0YSA9IG1hcHBlZFNlcmllcy5tYXAoKHNlcmllLCBpbmRleCkgPT4gdGhpcy5nZXREZWZhdWx0U2VyaWVPYmplY3Qoc2VyaWUsIGluZGV4KSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREZWZhdWx0U2VyaWVPYmplY3Qoc2VyaWU6IG51bWJlcltdLCBpbmRleDogbnVtYmVyKTogTXVsdGlTZXJpZURhdGEge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbHVlczogc2VyaWUsXHJcbiAgICAgICAgICAgIG5hbWU6IGBzZXJpZSR7aW5kZXh9YCxcclxuICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgY29sb3I6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNiksXHJcbiAgICAgICAgICAgICAgICBzaG93TGFiZWxzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHNob3dPbkxlZ2VuZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBlZGdlVGhpY2tuZXNzOiAwLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZHJhdygpOiB2b2lkIHtcclxuICAgICAgICAvLyB0aGlzLmNoYXJ0RHJhZnRzbWFuLmRyYXdMaW5lcyh0aGlzLnNlcmllc0RhdGFbMF0udmFsdWVzKTtcclxuICAgICAgICAvLyB0aGlzLmNoYXJ0RHJhZnRzbWFuLmRyYXdCYXJzKHRoaXMuc2VyaWVzRGF0YVswXS52YWx1ZXMpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgQ2hhcnRPcHRpb25zLCBTaW5nbGVTZXJpZURhdGEgfSBmcm9tIFwiLi4vbW9kZWwvdHlwZXNcIjtcclxuaW1wb3J0IFBsb3RTa2VsZXRvbiBmcm9tIFwiLi9QbG90U2tlbGV0b25cIjtcclxuaW1wb3J0IHsgUGllUGFydERhdGEgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGllUGxvdCBleHRlbmRzIFBsb3RTa2VsZXRvbiB7XHJcblxyXG4gICAgY29uc3RydWN0b3Ioc2tlbGV0b246IFBsb3RTa2VsZXRvbikge1xyXG4gICAgICAgIHN1cGVyKHNrZWxldG9uLmN0eCk7XHJcbiAgICB9XHJcblxyXG4gICAgZHJhd1BpZShzZXJpZXM6IFNpbmdsZVNlcmllRGF0YVtdLCBjaGFydE9wdGlvbnM6IENoYXJ0T3B0aW9ucyk6IHZvaWQge1xyXG4gICAgICAgIC8vIHNob3VsZCBiZSAyIHRvIGZpbGwgd2hvbGUgYXZhaWxhYmxlIHNwYWNlXHJcbiAgICAgICAgY29uc3QgUkFESVVTX0RJVklERVIgPSAyLjU7XHJcbiAgICAgICAgY29uc3QgeyBjdHggfSA9IHRoaXM7XHJcbiAgICAgICAgY29uc3QgcGxvdEZyYW1lID0gdGhpcy5wcmVwYXJlQ2hhcnRGb3JEcmF3aW5nKGNoYXJ0T3B0aW9ucyk7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMubWFwU2VyaWVzVG9QaWVEZWdBbmRDb2xvcihzZXJpZXMpO1xyXG4gICAgICAgIGNvbnN0IHJhZGl1cyA9IE1hdGgubWluKHBsb3RGcmFtZS53LCBwbG90RnJhbWUuaCkgLyBSQURJVVNfRElWSURFUjtcclxuICAgICAgICBjb25zdCBjZW50ZXIgPSB7XHJcbiAgICAgICAgICAgIHg6IHBsb3RGcmFtZS54ICsgcGxvdEZyYW1lLncgLyAyLFxyXG4gICAgICAgICAgICB5OiBwbG90RnJhbWUueSArIHBsb3RGcmFtZS5oIC8gMlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHRvdGFsID0gMDtcclxuICAgICAgICAvL2ZpbGxcclxuICAgICAgICBkYXRhLmZvckVhY2goZW50cnkgPT4ge1xyXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gZW50cnkuY29sb3I7XHJcbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY3R4Lm1vdmVUbyhjZW50ZXIueCwgY2VudGVyLnkpO1xyXG4gICAgICAgICAgICBjdHguYXJjKGNlbnRlci54LCBjZW50ZXIueSwgcmFkaXVzLCB0b3RhbCwgdG90YWwgKz0gZW50cnkucmFkKTtcclxuICAgICAgICAgICAgY3R4LmxpbmVUbyhjZW50ZXIueCwgY2VudGVyLnkpO1xyXG4gICAgICAgICAgICBjdHguZmlsbCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRvdGFsID0gMDtcclxuICAgICAgICAvL3N0cm9rZVxyXG4gICAgICAgIGRhdGEuZm9yRWFjaChlbnRyeSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbnRyeS50aGlja25lc3MgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IGVudHJ5LnRoaWNrbmVzcztcclxuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oY2VudGVyLngsIGNlbnRlci55KTtcclxuICAgICAgICAgICAgICAgIGN0eC5hcmMoY2VudGVyLngsIGNlbnRlci55LCByYWRpdXMsIHRvdGFsLCB0b3RhbCArPSBlbnRyeS5yYWQpO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhjZW50ZXIueCwgY2VudGVyLnkpO1xyXG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdG90YWwgKz0gZW50cnkucmFkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBtYXBTZXJpZXNUb1BpZURlZ0FuZENvbG9yKHNlcmllczogU2luZ2xlU2VyaWVEYXRhW10pOiBQaWVQYXJ0RGF0YVtdIHtcclxuICAgICAgICBjb25zdCB0b3RhbCA9IHNlcmllcy5tYXAoc2VyaWUgPT4gc2VyaWUudmFsdWUpLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApO1xyXG4gICAgICAgIHJldHVybiBzZXJpZXMubWFwKHNlcmllID0+ICh7XHJcbiAgICAgICAgICAgIHJhZDogc2VyaWUudmFsdWUgKiAyICogTWF0aC5QSSAvIHRvdGFsLFxyXG4gICAgICAgICAgICBjb2xvcjogc2VyaWUub3B0aW9ucy5jb2xvcixcclxuICAgICAgICAgICAgdGhpY2tuZXNzOiBzZXJpZS5vcHRpb25zLmVkZ2VUaGlja25lc3NcclxuICAgICAgICB9KSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IFNpbmdsZVNlcmllRGF0YSwgQ29udGV4dFNvdXJjZSB9IGZyb20gXCIuL3R5cGVzXCI7XHJcbmltcG9ydCB7IENoYXJ0IH0gZnJvbSBcIi4vQ2hhcnRcIjtcclxuaW1wb3J0IENoYXJ0VXRpbHMgZnJvbSBcIi4vdXRpbHNcIjtcclxuaW1wb3J0IFBpZVBsb3QgZnJvbSBcIi4uL3Bsb3QvUGllUGxvdFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBpZUNoYXJ0IGV4dGVuZHMgQ2hhcnQge1xyXG5cclxuICAgIHNlcmllc0RhdGE6IFNpbmdsZVNlcmllRGF0YVtdO1xyXG4gICAgcGxvdDogUGllUGxvdDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2U6IENvbnRleHRTb3VyY2UpIHtcclxuICAgICAgICBzdXBlcihzb3VyY2UpO1xyXG4gICAgICAgIHRoaXMucGxvdCA9IG5ldyBQaWVQbG90KHRoaXMucGxvdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBYKGxhYmVsczogc3RyaW5nW10pIHtcclxuICAgICAgICB0aGlzLnNlcmllc0RhdGEgPVxyXG4gICAgICAgICAgICBsYWJlbHMubWFwKChsYWJlbCkgPT4gdGhpcy5nZXREZWZhdWx0U2VyaWVPYmplY3QobGFiZWwpKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IFkodmFsdWVzOiBudW1iZXJbXSkge1xyXG4gICAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzLnNlcmllc0RhdGE7XHJcbiAgICAgICAgaWYgKCFsZW5ndGgpXHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdWYWx1ZXMgb24gXCJYXCIgYXhpcyBtdXN0IGJlIHNwZWNpZmllZCBiZWZvcmUgc2V0dGluZyBcIllcIiB2YWx1ZXMuJyk7XHJcbiAgICAgICAgY29uc3QgbWFwcGVkVmFsdWVzID0gQ2hhcnRVdGlscy5zbGljZU9yRmlsbCh2YWx1ZXMsIGxlbmd0aCk7XHJcbiAgICAgICAgdGhpcy5zZXJpZXNEYXRhLm1hcCgob3B0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBvcHRpb24udmFsdWUgPSBtYXBwZWRWYWx1ZXNbaW5kZXhdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RGVmYXVsdFNlcmllT2JqZWN0KGxhYmVsOiBzdHJpbmcpOiBTaW5nbGVTZXJpZURhdGEge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbHVlOiAwLFxyXG4gICAgICAgICAgICBuYW1lOiBsYWJlbCxcclxuICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgY29sb3I6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNiksXHJcbiAgICAgICAgICAgICAgICBzaG93TGFiZWxzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHNob3dPbkxlZ2VuZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBlZGdlVGhpY2tuZXNzOiAwLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZHJhdygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnBsb3QuZHJhd1BpZSh0aGlzLnNlcmllc0RhdGEsIHRoaXMuY2hhcnRPcHRpb25zKTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IENvbnRleHRTb3VyY2UgfSBmcm9tIFwiLi4vbW9kZWwvdHlwZXNcIjtcclxuaW1wb3J0IHsgQmFyQ2hhcnQgfSBmcm9tIFwiLi4vbW9kZWwvQmFyQ2hhcnRcIjtcclxuaW1wb3J0IHsgQ2hhcnQgfSBmcm9tIFwiLi4vbW9kZWwvQ2hhcnRcIjtcclxuaW1wb3J0IHsgUGllQ2hhcnQgfSBmcm9tIFwiLi4vbW9kZWwvUGllQ2hhcnRcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHNlcnZlQ2hhcnQodHlwZTogc3RyaW5nLCBzb3VyY2U6IENvbnRleHRTb3VyY2UpOiBDaGFydCB7XHJcbiAgICBzd2l0Y2ggKHR5cGUudG9Mb3dlckNhc2UoKS50cmltKCkpIHtcclxuICAgICAgICBjYXNlIFwicGllXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGllQ2hhcnQoc291cmNlKTtcclxuICAgICAgICBjYXNlIFwiYmFyXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmFyQ2hhcnQoc291cmNlKTtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dHlwZX0gY2hhcnQgaXMgbm90IGRlZmluZWQuYCk7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJQbG90U2tlbGV0b24iLCJjb25zdHJ1Y3RvciIsImN0eCIsInRoaXMiLCJzdHJva2VGcmFtZUZvclRlc3QiLCJmcmFtZSIsImNvbG9yIiwic3Ryb2tlU3R5bGUiLCJzdHJva2VSZWN0IiwieCIsInkiLCJ3IiwiaCIsImdldENvbnRlbnRGcmFtZSIsIndpZHRoIiwiaGVpZ2h0IiwiY2FudmFzIiwicGFkZGluZyIsIk1hdGgiLCJmbG9vciIsIm1pbiIsImdldFRpdGxlRnJhbWUiLCJjb250ZW50RnJhbWUiLCJuZXdIIiwiZ2V0UmVtYWluaW5nQ29udGVudEZyYW1lIiwicHJldiIsInJlY2VudCIsImdldExlZ2VuZEZyYW1lIiwiZHJhd1RpdGxlIiwidGl0bGUiLCJ0aXRsZUZyYW1lIiwiZm9udCIsInRleHRNZWFzdXJlbWVudCIsIm1lYXN1cmVUZXh0IiwidGV4dFBvc2l0aW9uWCIsInRleHRQb3NpdGlvblkiLCJhY3R1YWxCb3VuZGluZ0JveEFzY2VudCIsImZpbGxUZXh0IiwiZHJhd0xlZ2VuZCIsImxlZ2VuZEZyYW1lIiwicHJlcGFyZUNoYXJ0Rm9yRHJhd2luZyIsImNoYXJ0T3B0aW9ucyIsImNsZWFyUmVjdCIsInNob3dUaXRsZSIsInNob3dMZWdlbmQiLCJzdGF0aWMiLCJhcnJheSIsImxlbiIsImZpbGxXaXRoIiwibGVuZ3RoIiwic2xpY2UiLCJwdXNoIiwibmV3T3B0aW9ucyIsImFjdHVhbE9wdGlvbnMiLCJrZXlzIiwiZW50cmllcyIsImZvckVhY2giLCJwYWlyIiwiaW5jbHVkZXMiLCJ2YWx1ZSIsIkNoYXJ0Iiwic291cmNlIiwiYW5hbHl6ZWRFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJlcGxhY2UiLCJIVE1MQ2FudmFzRWxlbWVudCIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEIiwiRXJyb3IiLCJzZXJpZXNEYXRhIiwicGxvdCIsInNldENoYXJ0T3B0aW9ucyIsIm9wdGlvbnMiLCJzZXRTZXJpZU9wdGlvbnMiLCJ3aGljaFNlcmllcyIsInNlcmllTmFtZSIsImFjdHVhbFNlcmllIiwiZmluZCIsImV4aXN0aW5nU2VyaWUiLCJuYW1lIiwiY29uc29sZSIsIndhcm4iLCJzZXJpZSIsIkJhckNoYXJ0Iiwic3VwZXIiLCJYIiwibGFiZWxzIiwiZGF0YUxhYmVscyIsIlkiLCJzZXJpZXMiLCJtYXBwZWRTZXJpZXMiLCJtYXAiLCJpbmRleCIsImdldERlZmF1bHRTZXJpZU9iamVjdCIsInZhbHVlcyIsInJhbmRvbSIsInRvU3RyaW5nIiwic2hvd0xhYmVscyIsInNob3dPbkxlZ2VuZCIsImVkZ2VUaGlja25lc3MiLCJkcmF3IiwiUGllUGxvdCIsInNrZWxldG9uIiwiZHJhd1BpZSIsInBsb3RGcmFtZSIsImRhdGEiLCJtYXBTZXJpZXNUb1BpZURlZ0FuZENvbG9yIiwicmFkaXVzIiwiY2VudGVyIiwidG90YWwiLCJlbnRyeSIsImZpbGxTdHlsZSIsImJlZ2luUGF0aCIsIm1vdmVUbyIsImFyYyIsInJhZCIsImxpbmVUbyIsImZpbGwiLCJ0aGlja25lc3MiLCJsaW5lV2lkdGgiLCJzdHJva2UiLCJyZWR1Y2UiLCJhIiwiYiIsIlBJIiwiUGllQ2hhcnQiLCJsYWJlbCIsIm1hcHBlZFZhbHVlcyIsIm9wdGlvbiIsInNlcnZlQ2hhcnQiLCJ0eXBlIiwidG9Mb3dlckNhc2UiLCJ0cmltIl0sInNvdXJjZVJvb3QiOiIifQ==